# 迁移到 Taro 小程序 - 任务清单

## 阶段 1: 项目初始化 ✅

### T-1.1: 创建 Taro 项目 ✅
**对应**: AC-1, P-1  
**预估**: 30分钟

- [x] 安装 Taro CLI: `npm install -g @tarojs/cli`
- [x] 手动创建项目结构（CLI 初始化遇到问题）
- [x] 配置 package.json, tsconfig.json, project.config.json
- [x] 创建 app.ts, app.config.ts, app.scss

### T-1.2: 配置项目基础 ✅
**对应**: AC-1, P-1  
**预估**: 30分钟

- [x] 配置 `tsconfig.json` 路径别名
- [x] 创建目录结构（types, constants, utils, components, store, styles）
- [x] 复制 `types.ts` 到 `src/types/index.ts`
- [x] 复制 `constants.ts` 到 `src/constants/index.ts`
- [x] 创建 SCSS 变量文件 `src/styles/variables.scss` 和 `mixins.scss`

### T-1.3: 安装依赖 ✅
**对应**: P-5, P-3  
**预估**: 15分钟

- [x] 安装 Zustand: `npm install zustand`
- [x] 安装所有 Taro 依赖
- [x] 依赖安装成功（使用国内镜像）

---

## 阶段 2: 页面结构搭建 ✅

### T-2.1: 配置 TabBar ✅
**对应**: AC-2, P-2  
**预估**: 45分钟

- [x] 配置 `app.config.ts` 的 tabBar
- [x] 创建 4 个 Tab 页面目录和文件
  - `pages/home/index.tsx` + `index.config.ts` + `index.scss`
  - `pages/recipes/index.tsx` + `index.config.ts` + `index.scss`
  - `pages/summary/index.tsx` + `index.config.ts` + `index.scss`
  - `pages/profile/index.tsx` + `index.config.ts` + `index.scss`
- [ ] 准备 TabBar 图标（8张：4个默认 + 4个选中）- 待设计
- [ ] 测试 TabBar 切换 - 待微信开发者工具测试

### T-2.2: 创建子页面 ✅
**对应**: AC-3, P-2  
**预估**: 30分钟

- [x] 创建 `pages/menu-select/index.tsx` - 选菜页面
- [x] 创建 `pages/dish-detail/index.tsx` - 菜品详情
- [x] 创建 `pages/shopping-list/index.tsx` - 购物清单
- [x] 创建 `pages/create-recipe/index.tsx` - 创建菜谱（占位）
- [x] 创建 `pages/category-manager/index.tsx` - 分类管理（占位）
- [x] 在 `app.config.ts` 中注册所有页面路由

### T-2.3: 测试页面跳转 ⏳
**对应**: P-2  
**预估**: 15分钟

- [x] 实现基础页面跳转逻辑
- [ ] 测试 `navigateTo` 和 `navigateBack` - 待微信开发者工具测试
- [ ] 测试 URL 参数传递 - 待微信开发者工具测试

---

## 阶段 3: 状态管理和数据层 ✅

### T-3.1: 创建 Zustand Store ✅
**对应**: AC-8, P-3  
**预估**: 1小时

- [x] 创建 `src/store/index.ts`
- [x] 定义 Store 接口和初始状态
- [x] 实现菜单项相关方法（add, remove, clear）
- [x] 实现菜谱相关方法（add, update, delete）
- [x] 实现分类相关方法（add, update, delete）
- [x] 实现持久化方法（loadFromStorage, saveToStorage）

### T-3.2: 封装存储工具 ✅
**对应**: AC-5, P-6  
**预估**: 30分钟

- [x] 创建 `src/utils/storage.ts`
- [x] 实现 get, set, remove, clear 方法
- [x] 添加错误处理和类型支持
- [ ] 编写单元测试 - 待后续

### T-3.3: 迁移食材聚合逻辑 ✅
**对应**: AC-3, P-6  
**预估**: 30分钟

- [x] 创建 `src/utils/aggregator.ts`
- [x] 迁移 `useMenuAggregator` 逻辑为纯函数
- [x] 实现食材聚合和分组功能
- [ ] 测试聚合逻辑正确性 - 待微信开发者工具测试

---

## 阶段 4: 公共组件开发

### T-4.1: Navbar 组件
**对应**: AC-4, P-7  
**预估**: 45分钟

- [ ] 创建 `components/Navbar/index.tsx`
- [ ] 实现返回按钮、标题、右侧操作区
- [ ] 编写样式 `index.scss`
- [ ] 支持透明背景模式
- [ ] 测试在不同页面的显示效果

### T-4.2: DishCard 组件
**对应**: AC-4, P-7  
**预估**: 45分钟

- [ ] 创建 `components/DishCard/index.tsx`
- [ ] 实现菜品卡片布局（图片、标题、标签、时间）
- [ ] 编写样式（圆角、阴影、间距）
- [ ] 支持点击事件
- [ ] 支持不同尺寸变体

### T-4.3: IngredientList 组件
**对应**: AC-3, P-7  
**预估**: 30分钟

- [ ] 创建 `components/IngredientList/index.tsx`
- [ ] 实现食材列表展示（分组显示）
- [ ] 支持勾选状态
- [ ] 编写样式

### T-4.4: MealTabs 组件
**对应**: AC-3, P-7  
**预估**: 30分钟

- [ ] 创建 `components/MealTabs/index.tsx`
- [ ] 实现早中晚三餐切换
- [ ] 添加图标和主题色
- [ ] 编写样式和动画效果

---

## 阶段 5: 页面功能实现 ✅ (基础版)

### T-5.1: 明日菜单页面 (Home) ✅
**对应**: AC-3, P-2  
**预估**: 2小时

- [x] 迁移 HomePage 组件逻辑
- [x] 实现顶部 Banner
- [x] 实现餐次切换（早中晚三餐）
- [x] 实现菜品列表展示
- [x] 实现"加一道菜"按钮（跳转到选菜页）
- [x] 实现"生成买菜清单"按钮（跳转到购物清单页）
- [x] 编写页面样式
- [ ] 测试功能完整性 - 待微信开发者工具测试

### T-5.2: 选菜页面 (MenuSelect) ✅
**对应**: AC-3, P-2  
**预估**: 1.5小时

- [x] 实现菜品列表展示
- [x] 实现选择菜品逻辑
- [x] 实现用户选择器（选择谁点的菜）
- [x] 保存到 Store 并返回
- [x] 编写页面样式
- [ ] 实现分类筛选 - 待完善
- [ ] 实现搜索功能 - 待完善

### T-5.3: 菜谱库页面 (Recipes) ✅
**对应**: AC-3, P-2  
**预估**: 1.5小时

- [x] 迁移 RecipesPage 组件逻辑
- [x] 实现分类横向滚动
- [x] 实现菜品列表展示
- [x] 实现点击跳转到详情页
- [x] 实现"添加菜谱"按钮（FAB）
- [x] 编写页面样式
- [ ] 实现搜索栏 - 待完善
- [ ] 实现"管理分类"按钮 - 待完善

### T-5.4: 菜品详情页面 (DishDetail) ✅
**对应**: AC-3, P-2  
**预估**: 1小时

- [x] 接收菜品 ID 参数
- [x] 从 Store 获取菜品数据
- [x] 实现基本信息展示（时间、卡路里）
- [x] 实现食材列表展示
- [x] 编写页面样式
- [ ] 实现顶部大图展示 - 待完善
- [ ] 实现编辑和删除按钮 - 待完善
- [ ] 实现分享功能 - 待完善

### T-5.5: 购物清单页面 (ShoppingList) ✅
**对应**: AC-3, P-6  
**预估**: 1.5小时

- [x] 从 Store 获取菜单项
- [x] 调用聚合工具生成食材清单
- [x] 实现分组展示（蔬菜、肉类、调料、其他）
- [x] 实现勾选功能（标记已购买）
- [x] 编写页面样式
- [ ] 实现清空清单功能 - 待完善
- [ ] 实现分享清单功能 - 待完善

### T-5.6: 创建菜谱页面 (CreateRecipe) ⏳
**对应**: AC-3, P-2  
**预估**: 2小时

- [x] 创建页面占位
- [ ] 实现表单布局（名称、分类、时间、卡路里）
- [ ] 实现封面图片上传（使用 `Taro.chooseImage`）
- [ ] 实现标签输入
- [ ] 实现食材列表编辑（添加、删除、修改）
- [ ] 实现保存逻辑（保存到 Store）
- [ ] 实现表单验证
- [ ] 编写页面样式

### T-5.7: 分类管理页面 (CategoryManager) ⏳
**对应**: AC-3, P-2  
**预估**: 1小时

- [x] 创建页面占位
- [ ] 实现分类列表展示
- [ ] 实现添加分类功能
- [ ] 实现编辑分类功能
- [ ] 实现删除分类功能（带确认）
- [ ] 实现 Emoji 选择器（可选）
- [ ] 保存到 Store
- [ ] 编写页面样式

### T-5.8: 回忆录页面 (Summary) ✅ (简化版)
**对应**: AC-3, P-2  
**预估**: 1.5小时

- [x] 创建基础页面结构
- [x] 实现统计卡片（烹饪次数、最爱菜品）
- [x] 编写页面样式
- [ ] 实现时间范围切换（本周、本月、本年）- 待完善
- [ ] 实现口味偏好图表 - 待完善
- [ ] 实现历史记录列表 - 待完善

### T-5.9: 我的页面 (Profile) ✅ (简化版)
**对应**: AC-3, P-2  
**预估**: 1小时

- [x] 创建基础页面结构
- [x] 实现用户信息展示
- [x] 实现设置和关于入口
- [x] 编写页面样式
- [ ] 实现成就系统展示 - 待完善

---

## 阶段 6: 样式适配

### T-6.1: 全局样式配置
**对应**: AC-4, P-4  
**预估**: 30分钟

- [ ] 完善 `variables.scss`（颜色、字体、间距）
- [ ] 创建 `mixins.scss`（卡片、按钮、阴影）
- [ ] 创建 `app.scss` 全局样式
- [ ] 配置 rpx 单位转换

### T-6.2: 页面样式精修
**对应**: AC-4, P-4  
**预估**: 2小时

- [ ] 调整所有页面的间距和圆角
- [ ] 统一阴影效果
- [ ] 优化颜色使用
- [ ] 添加过渡动画
- [ ] 适配安全区域（iPhone 刘海屏）

### T-6.3: 响应式适配
**对应**: AC-4  
**预估**: 1小时

- [ ] 测试不同屏幕尺寸（iPhone SE, iPhone 14, iPad）
- [ ] 调整布局断点
- [ ] 优化横屏显示
- [ ] 测试字体大小可读性

---

## 阶段 7: 图标和资源

### T-7.1: 替换图标
**对应**: AC-6, P-5  
**预估**: 1小时

- [ ] 列出所有使用的 Lucide 图标
- [ ] 在 NutUI Icons 中找到对应图标
- [ ] 替换所有图标引用
- [ ] 对于缺失的图标，创建自定义 SVG 组件
- [ ] 测试图标显示效果

### T-7.2: 处理图片资源
**对应**: AC-6  
**预估**: 30分钟

- [ ] 评估是否保留 picsum.photos（需配置域名）
- [ ] 或准备本地占位图片
- [ ] 配置小程序合法域名白名单
- [ ] 测试图片加载

### T-7.3: 准备小程序资源
**对应**: AC-10  
**预估**: 30分钟

- [ ] 设计小程序图标（1024x1024）
- [ ] 准备 TabBar 图标（8张）
- [ ] 准备启动页图片
- [ ] 优化图片大小

---

## 阶段 8: 小程序特性集成

### T-8.1: 添加交互反馈
**对应**: AC-7, P-8  
**预估**: 1小时

- [ ] 在关键操作添加 Toast 提示
- [ ] 在异步操作添加 Loading 状态
- [ ] 在删除操作添加 Modal 确认
- [ ] 测试所有反馈效果

### T-8.2: 实现分享功能
**对应**: AC-7, P-8  
**预估**: 30分钟

- [ ] 在菜品详情页添加分享
- [ ] 在购物清单页添加分享
- [ ] 配置分享文案和图片
- [ ] 测试分享效果

### T-8.3: 优化启动性能
**对应**: AC-7, AC-9  
**预估**: 1小时

- [ ] 分析首屏加载时间
- [ ] 优化初始数据加载
- [ ] 使用骨架屏
- [ ] 延迟加载非关键资源

---

## 阶段 9: 性能优化

### T-9.1: 列表优化
**对应**: AC-9, P-9  
**预估**: 1小时

- [ ] 在长列表使用虚拟滚动
- [ ] 实现图片懒加载
- [ ] 优化列表渲染性能
- [ ] 测试滚动流畅度

### T-9.2: 减少 setData 调用
**对应**: AC-9, P-9  
**预估**: 30分钟

- [ ] 检查不必要的状态更新
- [ ] 合并批量更新
- [ ] 使用 useMemo 和 useCallback
- [ ] 使用性能分析工具检测

### T-9.3: 包体积优化
**对应**: AC-9  
**预估**: 30分钟

- [ ] 分析包体积
- [ ] 移除未使用的依赖
- [ ] 压缩图片资源
- [ ] 配置分包加载（如果需要）

---

## 阶段 10: 测试和修复

### T-10.1: 功能测试
**对应**: 所有 AC  
**预估**: 2小时

- [ ] 测试所有页面跳转
- [ ] 测试菜单增删改查
- [ ] 测试菜谱增删改查
- [ ] 测试分类管理
- [ ] 测试购物清单生成
- [ ] 测试数据持久化
- [ ] 测试搜索功能
- [ ] 记录 bug 并修复

### T-10.2: 兼容性测试
**对应**: AC-4, AC-9  
**预估**: 1小时

- [ ] 微信开发者工具测试
- [ ] iOS 真机测试
- [ ] Android 真机测试
- [ ] 不同屏幕尺寸测试
- [ ] 不同微信版本测试

### T-10.3: 边界情况测试
**对应**: 所有 AC  
**预估**: 1小时

- [ ] 测试空数据状态
- [ ] 测试网络异常
- [ ] 测试存储满
- [ ] 测试快速点击
- [ ] 测试返回和重进

---

## 阶段 11: 发布准备

### T-11.1: 小程序配置
**对应**: AC-10  
**预估**: 30分钟

- [ ] 配置 AppID
- [ ] 配置服务器域名白名单
- [ ] 配置隐私协议
- [ ] 配置版本号和描述

### T-11.2: 构建和上传
**对应**: AC-10  
**预估**: 30分钟

- [ ] 执行生产构建: `npm run build:weapp`
- [ ] 检查构建产物
- [ ] 使用开发者工具上传代码
- [ ] 填写版本信息

### T-11.3: 提交审核
**对应**: AC-10  
**预估**: 30分钟

- [ ] 准备审核材料（截图、说明）
- [ ] 填写功能介绍
- [ ] 提交审核
- [ ] 跟踪审核状态

---

## 总结

**总任务数**: 60+  
**预估总工时**: 30-35 小时  
**建议周期**: 5-7 个工作日

**关键路径**:
1. 项目初始化 → 页面结构 → 状态管理 → 组件开发 → 页面实现 → 样式适配 → 测试 → 发布

**并行任务**:
- 组件开发可以与页面实现并行
- 样式适配可以在功能开发时同步进行
- 图标替换可以在组件开发时处理
