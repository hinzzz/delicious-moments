# 迁移到 Taro 小程序 - 需求文档

## 项目背景

当前的 Delicious Moments (食光集) 是一个基于 React + Vite 的 Web 应用，需要迁移到微信小程序平台以获得更好的用户触达和体验。

## 目标

将现有 React Web 应用完整迁移到 Taro 框架，实现微信小程序发布，同时保持所有核心功能和用户体验。

## 核心需求

### AC-1: 项目结构迁移
**作为** 开发者  
**我想要** 将单文件 React 应用重构为 Taro 多页面结构  
**以便** 符合小程序的页面架构规范

**验收标准：**
- 创建独立的 Taro 项目
- 将 App.tsx 拆分为 4 个独立页面（home, recipes, summary, profile）
- 配置 app.config.ts 和页面路由
- 保留 types.ts 和 constants.ts 的类型定义

### AC-2: TabBar 导航
**作为** 用户  
**我想要** 通过底部 TabBar 切换主要功能模块  
**以便** 快速访问不同功能

**验收标准：**
- 使用小程序原生 TabBar（4个标签）
- 标签：明日菜单、菜谱、回忆录、我的
- 每个标签有对应的图标和文字
- 切换流畅无闪烁

### AC-3: 页面功能完整性
**作为** 用户  
**我想要** 所有原有功能在小程序中正常工作  
**以便** 完成菜单规划和购物清单生成

**验收标准：**
- 明日菜单：查看/添加/删除三餐菜品
- 菜谱库：浏览/搜索/创建菜谱
- 购物清单：自动聚合食材并分类
- 分类管理：增删改分类
- 菜品详情：查看完整信息

### AC-4: 样式和交互适配
**作为** 用户  
**我想要** 小程序界面与原 Web 版保持一致的视觉风格  
**以便** 获得熟悉的使用体验

**验收标准：**
- 保持 "Creamy Mochi" 设计风格
- 颜色主题一致（橙色主色、绿色辅色）
- 圆角、阴影、间距保持一致
- 触摸反馈和动画效果流畅
- 适配不同屏幕尺寸和安全区域

### AC-5: 数据持久化
**作为** 用户  
**我想要** 我的菜单和菜谱数据能够保存  
**以便** 下次打开小程序时继续使用

**验收标准：**
- 使用小程序本地存储保存数据
- 菜单项、自定义菜谱、分类数据持久化
- 应用重启后数据不丢失
- 数据结构与原应用兼容

### AC-6: 图标和资源适配
**作为** 开发者  
**我想要** 替换不兼容的图标库和资源  
**以便** 在小程序环境中正常显示

**验收标准：**
- 替换 Lucide React 图标为小程序兼容方案
- 处理网络图片资源（picsum.photos）
- 配置合法域名或使用本地资源
- 所有图标和图片正常显示

### AC-7: 小程序特性集成
**作为** 用户  
**我想要** 使用小程序的原生能力  
**以便** 获得更好的体验

**验收标准：**
- 支持分享功能（分享菜单到好友/群）
- 添加 Toast 提示反馈
- 添加 Loading 加载状态
- 添加 Modal 确认对话框
- 优化启动性能

### AC-8: 跨页面状态管理
**作为** 开发者  
**我想要** 合理管理跨页面的状态  
**以便** 保证数据一致性

**验收标准：**
- 选择合适的状态管理方案（本地存储/Zustand/Redux）
- 页面间数据传递正确
- 返回时状态保持
- 避免重复请求和计算

### AC-9: 性能优化
**作为** 用户  
**我想要** 小程序运行流畅不卡顿  
**以便** 获得良好的使用体验

**验收标准：**
- 首屏加载时间 < 2秒
- 页面切换流畅（< 300ms）
- 长列表使用虚拟滚动
- 图片懒加载
- 减少不必要的 setData 调用

### AC-10: 发布就绪
**作为** 产品负责人  
**我想要** 小程序能够通过微信审核  
**以便** 正式发布给用户使用

**验收标准：**
- 配置正确的 AppID
- 设置服务器域名白名单
- 准备小程序图标和启动页
- 配置隐私协议
- 通过微信开发者工具预览和真机测试

## 非功能需求

### 兼容性
- 支持微信小程序基础库 2.10.0+
- 兼容 iOS 和 Android 平台
- 适配不同屏幕尺寸（iPhone SE 到 iPad）

### 可维护性
- 代码结构清晰，组件化
- TypeScript 类型完整
- 关键逻辑有注释

### 性能
- 包体积 < 2MB（主包）
- 内存占用合理
- 无明显卡顿和白屏

## 技术约束

- 必须使用 Taro 3.x 框架
- 保持 React + TypeScript 技术栈
- 不引入过重的第三方库
- 遵循微信小程序开发规范

## 里程碑

1. **M1 - 项目初始化** (Day 1): Taro 项目创建，基础配置完成
2. **M2 - 页面结构** (Day 2): 4个主页面和子页面创建完成
3. **M3 - 功能迁移** (Day 3-4): 所有功能逻辑迁移完成
4. **M4 - 样式适配** (Day 5): UI 样式完全适配
5. **M5 - 测试优化** (Day 6): 功能测试和性能优化完成
6. **M6 - 发布准备** (Day 7): 提交审核

## 风险和依赖

### 风险
- Tailwind CSS 在小程序中的兼容性问题
- Lucide React 图标库不支持小程序
- 单文件拆分可能导致状态管理复杂化
- 网络图片需要配置域名白名单

### 依赖
- 微信小程序开发者账号
- 服务器域名（如需 API 调用）
- 设计资源（TabBar 图标等）

## 成功标准

- 所有 AC 验收标准通过
- 真机测试无严重 bug
- 性能指标达标
- 通过微信审核
